CREATE OR REPLACE FUNCTION miniudf(
	iState VARCHAR(42),
	iGender VARCHAR(42),
	iIncomeRange VARCHAR(42),
	iAge INTEGER,
	iHomeowner INTEGER,
	iOccupation VARCHAR(42),
	iMaritalStatus VARCHAR(42)) RETURNS numeric AS $$
SELECT (-1.696951027862e-3 +
 (CASE 
WHEN (  $1  IS NULL OR  $1  = ''  ) THEN 7.276665760239e-3
WHEN  $1  IN('AL', 'FL', 'IN', 'LA', 'NJ', 'NY', 'PA', 'TN', 'VA', 'WV')  THEN -2.721105099068e-2
WHEN  $1  IN('CA', 'NE', 'WA')  THEN 3.688793919025e-2
ELSE 7.276665760239e-3
END) +
 (CASE 
WHEN (  $2  IS NULL OR  $2  = ''  ) THEN 2.976026184226e-3
WHEN  $2  IN('Female')  THEN -3.042756877993e-3
ELSE 2.976026184226e-3
END) +
 (CASE 
WHEN (  $3  IS NULL OR  $3  = ''  ) THEN -4.387837893604e-2
WHEN  $3  IN('$100,000 to $124,999', '$125,000 to $149,999', '$150,000 to $199,999')  THEN -6.542650385402e-2
WHEN  $3  IN('$25,000 to $29,999', '$30,000 to $34,999', '$35,000 to $39,999')  THEN 4.878540374552e-2
WHEN  $3  IN('$40,000 to $44,999', '$45,000 to $49,999')  THEN 2.085962416921e-2
WHEN  $3  IN('$50,000 to $59,999', '$60,000 to $74,999')  THEN -1.424863484174e-2
ELSE -4.387837893604e-2
END) +
 (CASE 
WHEN (  $4  IS NULL ) THEN -1.426806530498e-3
WHEN  $4  < 2.1e1 THEN 1.510784136033e-2
WHEN  $4  <= 2.699400007725e1 THEN  ( -9.771889896606e-4* $4 +3.562881014321e-2 ) 
WHEN  $4  <= 2.7e1 THEN  ( 4.502246084683e-1* $4 -1.214411254529e1 ) 
WHEN  $4  <= 4.619698760212e1 THEN  ( -8.361681177095e-4* $4 +3.452842253101e-2 ) 
WHEN  $4  <= 5.6e1 THEN  ( -4.363967377792e-4* $4 +1.606018904869e-2 ) 
WHEN  $4  <= 5.600900000043e1 THEN  ( 5.880664663515e-1* $4 -3.294010014395e1 ) 
WHEN  $4  <= 6.5e1 THEN  ( -9.771889896606e-4* $4 +5.164594830392e-2 ) 
WHEN  $4  >= 6.5e1 THEN -1.187133602402e-2
ELSE -1.426806530498e-3
END)+
 (CASE 
WHEN (  $5  IS NULL ) THEN -4.977613680504e-2
WHEN  $5  IN(1)  THEN 7.894564914254e-2
ELSE -4.977613680504e-2
END) +
 (CASE 
WHEN (  $6  IS NULL OR  $6  = ''  ) THEN -1.575104837286e-3
WHEN  $6  IN('Management', 'Service')  THEN 3.919930717699e-3
ELSE -1.575104837286e-3
END) +
 (CASE 
WHEN (  $7  IS NULL OR  $7  = ''  ) THEN 2.103771573957e-3
WHEN  $7  IN('Divorced', 'Never married', 'Separated')  THEN -3.103555923027e-3
ELSE 2.103771573957e-3
END) );
$$ LANGUAGE SQL IMMUTABLE;
