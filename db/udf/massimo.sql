CREATE OR REPLACE FUNCTION massimo(
	iState VARCHAR(42),
	iGender VARCHAR(42),
	iIncomeRange VARCHAR(42),
	iAge INTEGER,
	iHomeowner INTEGER,
	iMaritalStatus VARCHAR(42)) RETURNS numeric as $$
SELECT (-4.391879681117e-4 + 
 (CASE 
WHEN (  $1  IS NULL OR  $1  = ''  ) THEN 7.993274795158e-4
WHEN  $1  IN('AL', 'CT', 'KS', 'MT', 'NE', 'NY', 'OK', 'OR', 'UT', 'WA', 'WV')  THEN -7.727184628379e-4
WHEN  $1  IN('CA', 'GA', 'IA', 'IN', 'LA', 'ME', 'MN', 'MO', 'SD')  THEN 3.774868721493e-4
WHEN  $1  IN('CO', 'FL', 'IL', 'KY', 'MA', 'MD', 'MI', 'NC', 'ND', 'NJ', 'OH', 'PA', 'TN', 'VA', 'VT', 'WI')  THEN -1.125465152549e-4
ELSE 7.993274795158e-4
END) +
 (CASE 
WHEN (  $2  IS NULL OR  $2  = ''  ) THEN 9.654425987832e-4
WHEN  $2  IN('Female')  THEN -9.870904776731e-4
ELSE 9.654425987832e-4
END) +
 (CASE 
WHEN (  $3  IS NULL OR  $3  = ''  ) THEN 1.204971943367e-4
WHEN  $3  IN('$25,000 to $29,999', '$30,000 to $34,999')  THEN -5.111096442985e-4
ELSE 1.204971943367e-4
END) +
 (CASE 
WHEN (  $4  IS NULL ) THEN 5.33495357291e-5
WHEN  $4  < 2.1e1 THEN -1.326267820032e-3
WHEN  $4  <= 2.49960000515e1 THEN  ( 2.836458029062e-5* $4 -1.921924006135e-3 ) 
WHEN  $4  <= 2.5e1 THEN  ( 4.750284274288e-2* $4 -1.188593982603e0 ) 
WHEN  $4  <= 2.997036481929e1 THEN  ( 6.657011946009e-5* $4 -2.687167017582e-3 ) 
WHEN  $4  <= 3.6e1 THEN  ( 5.432554302742e-5* $4 -2.320192594837e-3 ) 
WHEN  $4  <= 3.947155075132e1 THEN  ( 7.34554187821e-5* $4 -3.008868122006e-3 ) 
WHEN  $4  <= 4.5e1 THEN  ( 4.614445492694e-5* $4 -1.93086202613e-3 ) 
WHEN  $4  <= 4.901015228426e1 THEN  ( 7.738772335704e-5* $4 -3.336809105484e-3 ) 
WHEN  $4  <= 5.082056647872e1 THEN  ( -2.592969936958e-5* $4 +1.726793515965e-3 ) 
WHEN  $4  <= 5.2e1 THEN  ( -9.956266076895e-5* $4 +5.468862325787e-3 ) 
WHEN  $4  <= 5.552038834951e1 THEN  ( -5.735418787357e-5* $4 +3.274021735228e-3 ) 
WHEN  $4  <= 5.738064977924e1 THEN  ( 1.094723611535e-4* $4 -5.988253053762e-3 ) 
WHEN  $4  <= 5.8e1 THEN  ( 7.600727243363e-4* $4 -4.332012463981e-2 ) 
WHEN  $4  <= 5.800700000033e1 THEN  ( 6.476887586879e-2* $4 -3.755830707018e0 ) 
WHEN  $4  <= 6.5e1 THEN  ( 2.836458029062e-5* $4 -4.278686846105e-4 ) 
WHEN  $4  >= 6.5e1 THEN 1.41582903428e-3
ELSE 5.33495357291e-5
END)+
 (CASE 
WHEN (  $5  IS NULL ) THEN -1.220167081482e-4
WHEN  $5  IN(1)  THEN 1.935202056504e-4
ELSE -1.220167081482e-4
END) +
 (CASE 
WHEN (  $6  IS NULL OR  $6  = ''  ) THEN 3.998493587468e-4
WHEN  $6  IN('Divorced', 'Never married', 'Separated', 'Widowed')  THEN -5.208498496253e-4
ELSE 3.998493587468e-4
END) );
$$ LANGUAGE SQL IMMUTABLE;
