CREATE OR REPLACE FUNCTION proudf(
	iState VARCHAR(42),
	iGender VARCHAR(42),
	iIncomeRange VARCHAR(42),
	iAge INTEGER,
	iHomeowner INTEGER) RETURNS numeric AS $$
SELECT (-3.058522084965e-3 + 
 (CASE 
WHEN (  $1  IS NULL OR  $1  = ''  ) THEN 2.331770579276e-3
WHEN  $1  IN('AL', 'AR', 'CO', 'FL', 'GA', 'IA', 'IL', 'KS', 'LA', 'MD', 'MI', 'MN', 'MO', 'MS', 'MT', 'NC', 'ND', 'NE', 'OH', 'OK', 'SC', 'SD', 'TN', 'TX')  THEN -1.021891998037e-2
WHEN  $1  IN('CA', 'CT', 'MA', 'NJ', 'NY', 'OR', 'WA')  THEN 3.04137921723e-2
ELSE 2.331770579276e-3
END) +
 (CASE 
WHEN (  $2  IS NULL OR  $2  = ''  ) THEN 1.749241380082e-3
WHEN  $2  IN('Female')  THEN -1.788464183791e-3
ELSE 1.749241380082e-3
END) +
 (CASE 
WHEN (  $3  IS NULL OR  $3  = ''  ) THEN 1.559950047327e-2
WHEN  $3  IN('$25,000 to $29,999', '$35,000 to $39,999')  THEN -1.899062630313e-2
WHEN  $3  IN('$30,000 to $34,999', '$40,000 to $44,999')  THEN -1.233053723731e-2
WHEN  $3  IN('$45,000 to $49,999', '$50,000 to $59,999')  THEN -4.400399985098e-4
ELSE 1.559950047327e-2
END) +
 (CASE 
WHEN (  $4  IS NULL ) THEN 4.54547160011e-4
WHEN  $4  < 2.1e1 THEN -5.486092484528e-3
WHEN  $4  <= 3.498600018024e1 THEN  ( 5.75278599047e-5* $4 -6.694177542527e-3 ) 
WHEN  $4  <= 3.5e1 THEN  ( 1.432038033004e-1* $4 -5.014809795906e0 ) 
WHEN  $4  <= 4.088015342323e1 THEN  ( 3.983390446826e-4* $4 -1.661854695491e-2 ) 
WHEN  $4  <= 4.7e1 THEN  ( 3.7216507198e-4* $4 -1.554855093513e-2 ) 
WHEN  $4  <= 5.207105263158e1 THEN  ( 8.169486765032e-4* $4 -3.645338034772e-2 ) 
WHEN  $4  <= 5.442894415194e1 THEN  ( -7.591049022968e-4* $4 +4.561338850416e-2 ) 
WHEN  $4  <= 5.6e1 THEN  ( -1.781935718376e-3* $4 +1.012849898694e-1 ) 
WHEN  $4  <= 5.948059701493e1 THEN  ( -1.603049333927e-3* $4 +9.126735234029e-2 ) 
WHEN  $4  <= 6.126876775386e1 THEN  ( 1.673648708454e-3* $4 -1.036326034582e-1 ) 
WHEN  $4  <= 6.2e1 THEN  ( 9.722066596293e-3* $4 -5.967492498142e-1 ) 
WHEN  $4  <= 6.200300000014e1 THEN  ( 2.355731538686e0* $4 -1.460493365193e2 ) 
WHEN  $4  <= 6.5e1 THEN  ( 5.75278599047e-5* $4 +9.519174210051e-3 ) 
WHEN  $4  >= 6.5e1 THEN 1.325848510386e-2
ELSE 4.54547160011e-4
END)+
 (CASE 
WHEN (  $5  IS NULL ) THEN -5.202325949932e-3
WHEN  $5  IN(1)  THEN 8.250961716395e-3
ELSE -5.202325949932e-3
END) );
$$ LANGUAGE SQL IMMUTABLE;
